**产品需求文档（PRD）**

产品名称：AI 文档编辑器（桌面版）
版本：v0.1 MVP
撰写日期：2025-04-23
撰写人：ChatGPT（根据方先生需求）

---

## 一、产品概述

AI 文档编辑器是一个面向普通办公用户的桌面应用，基于 Electron 构建，内置 Markdown 文本编辑器（Monaco），具备 AI 辅助文档创作能力，目标是提升用户在日常项目管理、会议记录、任务分解等方面的写作效率。


## 二、核心目标

- 提供可视化文档目录浏览与管理功能
- 提供 AI 辅助能力，如：润色、总结、生成新文档、文档派生
- 支持自然语言创建与修改文件
- 提供简单直观的桌面应用交互界面（非程序员风格）


## 三、核心功能模块（MVP）

### 1. 文档管理模块
- 显示本地文档目录（`/docs/`）结构
- 支持 Markdown 文件浏览与编辑
- 支持新建、保存文件
- 可视化的文档树（左侧）

### 2. 编辑器模块
- 使用 Monaco 编辑器进行 Markdown 编辑
- 自动加载文档内容
- 支持 Ctrl+S 保存修改

### 3. AI 辅助模块（初版功能）
- **润色功能**：对当前文档进行语言润色（调用 OpenAI 接口）
- **文档创建功能**：通过自然语言创建新文档草稿（如：“写一个项目计划”）
- **多文件汇总功能**（可选）：选中多个文档后生成总结/对比/合并稿

### 4. 用户交互
- 顶部工具栏提供按钮触发 AI 操作（如：润色、创建、汇总）
- 文档树右键菜单可附加“AI 生成”选项


## 四、非功能需求

- 跨平台支持：Windows、macOS（基于 Electron）
- 网络连接：需联网使用 AI 功能（调用 OpenAI API）
- 安全性：仅访问用户授权的本地目录


## 五、技术栈

- Electron（主进程 / 渲染进程）
- Node.js（AI API 调用、本地文件系统操作）
- Monaco Editor（Markdown 编辑器）
- OpenAI API（GPT 模型：gpt-4 或 gpt-3.5）


## 六、未来可拓展功能（非本轮实现）

- 文档版本控制（Git 集成）
- 模板文档生成器（内置模板 + prompt 填空）
- 本地模型调用支持（如 Ollama）
- PDF 导出 / 打印
- 多用户协作


## 七、开发计划（建议）

### 阶段一：原型开发（当前阶段）
- 构建基本文件系统 + 编辑器界面
- 实现读取、保存、AI 润色、文档创建基础功能

### 阶段二：完善体验
- 文档树结构优化
- 增加目录选择器、最近文档
- 增加模板创建器、AI 汇总功能
- **增加 Office 文档支持模块（.docx/.xlsx/.pptx）**：
  - 支持 Word 文档读取与 Markdown 转换（使用 mammoth.js）
  - 支持 Excel 表格查看与编辑（使用 SheetJS）
  - 支持通过 Markdown 描述生成 PowerPoint 演示文稿（使用 PptxGenJS）

### 阶段三：增强智能
- 增加语义搜索、智能推荐
- AI 模型管理（可自定义 prompt、切换模型）
- 多文件 AI 分析与总结


## 八、验收标准

- 能启动桌面应用并看到界面
- 能显示 docs 目录内的 Markdown 文件并编辑
- 能保存文件修改
- 能使用 AI 对文档进行润色
- 能通过自然语言新建一个文件（如“写一个会议纪要”）

